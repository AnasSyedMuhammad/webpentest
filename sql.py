



import requests

import time
import sys

def sql_(url,payLoad):
    p1=[]
    p2=[]
    p3=[]
    print("\n[!] Testing SQLi")
    urlsplit = url.split("=")
    urlsplit = urlt[0] + '='
    new_url = urlsplit 

    


    user_payload =payLoad
    appedn_url = urlsplit + user_payload
    reqqq = requests.get(appedn_url).text
    if   'mysql_numrows()' or 'Input String was not in a correct format' or 'mysql_fetch' \
         'mysql_fetch_array()' or 'You have an error in your SQL syntax' or 'error in your SQL syntax' \
         or 'Error Occured While Processing Request' or 'Server Error' or 'Microsoft OLE DB Provider for ODBC Drivers Error' \
        or 'Invalid Querystring' or 'VBScript Runtime' or 'Syntax Error' or 'GetArray()' or 'FetchRows()' in reqqq:
        print("\ SQL Error found.")
        print(" User Payload:",user_payload)
        print("POC :",appedn_url)
        p2.append(' Found SQL Error ,   Payload:'+user_payload+',  POC:'+appedn_url)
    else:
        pass

    return p1,p2



def check_head(url_entered):
    head = requests.get(url_entered)
    header = head.headers
    p=[]

    try:
        
        p.append("Server:"+header['server'])
      
    except:
        pass
    
    try:
        
        p.append("Powered:"+header['x-powered-by'])
       
    except:
        pass
    return p
    
def get_banner(url_parsed):
    try:
        s = requests.get(url_parsed)
        if s.status_code == 200:
            s = s.status_code
        else:
            return "Error , status code:"+s.status_code

    except:
        
        return " Error Try differen url"

